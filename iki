<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mortgage Calculator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">
</head>

<body>

  <div class="calculator row">
    <div class="col-md-6 p-4">
      <div class="row mortgage-div">
        <h3 class="col-8">Mortgage Calculator</h3>
        <a class="clear col-4" href="index.html">Clear All</a>
      </div>

      <form action="javascript:void(0)">
        <div class="mb-3">
          <label for="mortgageAmount" class="form-label">Mortgage Amount</label>
          <div class="input-group">
            <span class="input-group-text">£</span>
            <input type="text" class="form-control" id="mortgageAmount" required>
          </div>
        </div>
        <div class="mb-3 inline-group">
          <div>
            <label for="mortgageTerm" class="form-label">Mortgage Term</label>
            <div class="input-group">
              <input type="text" class="form-control" id="mortgageTerm" required>
              <span class="input-group-text">years</span>
            </div>
          </div>
          <div>
            <label for="interestRate" class="form-label">Interest Rate</label>
            <div class="input-group">
              <input type="number" step="0.25" class="form-control interestInput" id="interestRate" required>
              <span class="input-group-text">%</span>
            </div>
          </div>
        </div>
        <div class="mb-4">
          <label class="form-label input-group">Mortgage Type</label>
          <div>
            <div class="input-group">
              <div class="input-group-text">
                <input class="form-check-input mt-0"  type="radio" name="mortgageType" id="repayment" value="repayment" required>
              </div>
              <input type="text" class="form-control"  value="Repayment" disabled >
            </div>
            <div class="input-group">
              <div class="input-group-text">
                <input class="form-check-input mt-0"  type="radio" name="mortgageType" id="interestOnly"
                  value="interestOnly"  required>
              </div>
              <input type="text" class="form-control" value="Interest Only" disabled>
            </div>
          </div>
        </div>
        <button id="calculateButton" onclick="calculateSum()"><img class="emote-calculator" src="assets/images/icon-calculator.svg">Calculate
          Repayments</button>
      </form>
    </div>

    <div class="results col-md-6">
      <img class="illustration" src="assets/images/illustration-empty.svg">
      <br>
      <h3>Results shown here</h3>
       <p class="p-illustration">Complete de form and click "calculate repayments" to see whats your monthly repayments would be</p>
    </div>
    <div class="results results-2 col-md-6">
      <h3 class="results-title">Your results</h3>
      <p class="results-information">Your results are shown below based on the information you provided. To adjust the results, edit the form and click "calculate repayments" again.</p>

      <div class="repayment-details">
        <div class="repayment-item">
          <p>Your monthly repayments:</p>
          <input type="text" id="result" class="form-control repayments-result">
      <hr>
          <p>Total you'll repay over the term:</p>
          <input type="text" id=="results2" class="form-control total-result">
        </div>
      </div>
    </div>
  </div>
<script src="calculation.js"></script>
</body>

</html>





document
  .getElementById("mortgageAmount")
  .addEventListener("input", function (e) {
    let inputValue = e.target.value;
    let lastKey = inputValue.substring(inputValue.length - 1);
    if (!lastKey.match(/^[0-9,]$/)) {
      e.target.value = inputValue.substring(0, inputValue.length - 1);
    } else {
      let valueWithoutCommas = inputValue.replace(/,/g, "");
      if (valueWithoutCommas.length > 3) {
        let valueWithCommas = "";
        for (let i = 0; i < valueWithoutCommas.length; i++) {
          if (i % 3 == 0 && i !== 0) {
            valueWithCommas += ",";
          }
          valueWithCommas += valueWithoutCommas[i];
        }
        e.target.value = valueWithCommas;
      }
    }
  });

document.getElementById("mortgageTerm").addEventListener("input", function (e) {
  let inputValue = e.target.value;
  let lastKey = inputValue.substring(inputValue.length - 1);
  if (!lastKey.match(/^[0-9]$/)) {
    e.target.value = inputValue.substring(0, inputValue.length - 1);
  }
});

document.getElementById("interestRate").addEventListener("input", function (e) {
  let inputValue = e.target.value;
  let lastKey = inputValue.substring(inputValue.length - 1);
  if (!lastKey.match(/^[0-9.]$/)) {
    e.target.value = inputValue.substring(0, inputValue.length - 1);
  } else {
    let dotIndex = inputValue.indexOf(".");
    if (dotIndex !== -1 && lastKey === ".") {
      e.target.value = inputValue.substring(0, inputValue.length - 1);
    }
  }
});

function calculateSum() {
  const mortgageAmount = parseFloat(document.getElementById("mortgageAmount").value.replace(/,/g, ""));
  const mortgageTerm = parseFloat(document.getElementById("mortgageTerm").value);
  const interestRate = parseFloat(document.getElementById("interestRate").value);

  if (isNaN(mortgageAmount) || isNaN(mortgageTerm) || isNaN(interestRate)) {
    alert("Please enter valid values in all fields.");
    return;
  }

  const isRepaymentSelected = document.getElementById("repayment").checked;
  const isInterestOnlySelected = document.getElementById("interestOnly").checked;

  if (!isRepaymentSelected && !isInterestOnlySelected) {
    alert("Please select a mortgage type: Repayment or Interest Only.");
    return;
  }
  if (isRepaymentSelected) {
    isRepayment();
  } else if (isInterestOnlySelected) {
    isInterestOnly();
  }
}

function isRepayment() {
  const mortgageAmount = parseFloat(document.getElementById("mortgageAmount").value.replace(/,/g, ""));
  const mortgageTerm = parseFloat(document.getElementById("mortgageTerm").value);
  const interestRate = parseFloat(document.getElementById("interestRate").value);

  const months = mortgageTerm * 12;
  const monthlyRate = interestRate / 100 / 12;
  const repayment = (mortgageAmount * monthlyRate) / (1 - Math.pow(1 + monthlyRate, -months));
  document.getElementById("result").value = `£${repayment.toFixed(2)}`;

  document.querySelector(".results").style.display = "none";
  document.querySelector(".results-2").style.display = "block";

}

function isInterestOnly() {
  const mortgageAmount = parseFloat(document.getElementById("mortgageAmount").value.replace(/,/g, ""));
  const mortgageTerm = parseFloat(document.getElementById("mortgageTerm").value);
  const interestRate = parseFloat(document.getElementById("interestRate").value);

  const monthlyInterest = (mortgageAmount * (interestRate / 100))*12;
  document.getElementById("result").value = `£${monthlyInterest.toFixed(2)}`;
  document.querySelector(".results").style.display = "none";
  document.querySelector(".results-2").style.display = "block";

}
